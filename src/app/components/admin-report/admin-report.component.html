<div class="report-container">
  <div class="report-header">
    <h1 class="report-title">Admin Investment Reports</h1>
    <div class="header-info">
      <p class="auto-update-info">
        <span class="material-icons">sync</span>
        Reports update automatically when rates or transactions change
      </p>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-message">
    <div class="loading-spinner">
      <div class="spinner"></div>
    </div>
    <h3>Loading Investment Data...</h3>
    <p>Please wait while we fetch your investment reports.</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-message">
    <div class="error-icon">
      <span class="material-icons">error</span>
    </div>
    <h3>Error Loading Data</h3>
    <p>{{ error }}</p>
    <button class="retry-btn" (click)="ngOnInit()">
      <span class="material-icons">refresh</span>
      Try Again
    </button>
  </div>

  <!-- No Data State -->
  <div *ngIf="!loading && !error && reports.length === 0" class="no-data-message">
    <div class="no-data-icon">
      <span class="material-icons">assessment</span>
    </div>
    <h3>No Investment Data Available</h3>
    <p>No investment data is currently available to generate reports. This could be due to:</p>
    <ul>
      <li>No investors have been added yet</li>
      <li>No transactions have been recorded</li>
      <li>Connection issues with the database</li>
    </ul>
  </div>


  <div *ngFor="let report of reports" class="report-card">
    <div class="report-card-header">
      <h2 class="investor-name">{{ report.investorName }}</h2>
    </div>

    <!-- Desktop Stats Grid -->
    <div class="stats-grid desktop-only">
      <div class="stat-card principal">
        <div class="stat-icon">
          <span class="material-icons">account_balance</span>
        </div>
        <div class="stat-content">
          <h3>Principal Amount</h3>
          <p class="stat-value">{{ report.principal | currency:'INR':'symbol':'1.2-2' }}</p>
        </div>
      </div>
      <div class="stat-card interest">
        <div class="stat-icon">
          <span class="material-icons">trending_up</span>
        </div>
        <div class="stat-content">
          <h3>Total Interest</h3>
          <p class="stat-value">{{ report.totalInterest | currency:'INR':'symbol':'1.2-2' }}</p>
          <div *ngIf="report.monthlyInterestBreakdown.length > 0" class="average-return">
            <small class="average-return-text">
              Average Return: {{ (report.averageReturnPercentage * 100).toFixed(2) }}%
            </small>
          </div>
        </div>
      </div>
      <div class="stat-card capital">
        <div class="stat-icon">
          <span class="material-icons">savings</span>
        </div>
        <div class="stat-content">
          <h3>Grown Capital</h3>
          <p class="stat-value">{{ report.grownCapital | currency:'INR':'symbol':'1.2-2' }}</p>
        </div>
      </div>
    </div>

    <!-- Mobile Stats Cards - Beautiful Design -->
    <div class="mobile-stats mobile-only">
      <div class="mobile-stat-card principal">
        <div class="mobile-stat-icon">
          <span class="material-icons">account_balance</span>
        </div>
        <div class="mobile-stat-content">
          <h4>PRINCIPAL AMOUNT</h4>
          <p class="mobile-stat-value">{{ report.principal | currency:'INR':'symbol':'1.2-2' }}</p>
        </div>
      </div>
      <div class="mobile-stat-card interest">
        <div class="mobile-stat-icon">
          <span class="material-icons">trending_up</span>
        </div>
        <div class="mobile-stat-content">
          <h4>TOTAL INTEREST</h4>
          <p class="mobile-stat-value">{{ report.totalInterest | currency:'INR':'symbol':'1.2-2' }}</p>
          <div *ngIf="report.monthlyInterestBreakdown.length > 0" class="mobile-average-return">
            <small>Average Return: {{ (report.averageReturnPercentage * 100).toFixed(2) }}%</small>
          </div>
        </div>
      </div>
      <div class="mobile-stat-card capital">
        <div class="mobile-stat-icon">
          <span class="material-icons">savings</span>
        </div>
        <div class="mobile-stat-content">
          <h4>GROWN CAPITAL</h4>
          <p class="mobile-stat-value">{{ report.grownCapital | currency:'INR':'symbol':'1.2-2' }}</p>
        </div>
      </div>
    </div>

    <div *ngIf="report.transactions.length > 0" class="transactions-section">
      <h3 class="section-title">Transaction History</h3>
      
      <!-- Desktop Table View -->
      <div class="table-container desktop-only">
        <table class="transactions-table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Description</th>
              <th>Principal</th>
              <th>Interest</th>
              <th>Withdrawal</th>
              <th>Balance</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let t of report.transactions">
              <td>{{ formatDate(t.date) }}</td>
              <td class="transaction-type">{{ t.type }}</td>
              <td class="amount principal-amount">
                <span *ngIf="t.type === 'invest' || t.type === 'deposit'">
                  {{ t.amount | currency:'INR':'symbol':'1.2-2' }}
                </span>
              </td>
              <td class="amount interest-amount">
                <span *ngIf="t.type === 'interest'">
                  {{ t.amount | currency:'INR':'symbol':'1.2-2' }}
                  <small class="interest-rate">({{ getTransactionInterestRate(t.date) }})</small>
                </span>
              </td>
              <td class="amount withdrawal-amount">
                <span *ngIf="t.type === 'withdraw'">
                  {{ t.amount | currency:'INR':'symbol':'1.2-2' }}
                </span>
              </td>
              <td class="amount balance-amount">{{ t.balance | currency:'INR':'symbol':'1.2-2' }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Mobile Card View - Beautiful Design -->
      <div class="mobile-cards mobile-only">
        <div *ngFor="let t of report.transactions" class="transaction-card-mobile">
          <div class="card-header-mobile">
            <div class="transaction-info-mobile">
              <span class="transaction-type-mobile" [ngClass]="t.type.toLowerCase()">
                {{ t.type }}
              </span>
              <span *ngIf="t.type === 'interest'" class="interest-rate-mobile">
                ({{ getTransactionInterestRate(t.date) }})
              </span>
            </div>
            <div class="transaction-date-mobile">
              {{ formatDate(t.date) }}
            </div>
          </div>
          <div class="card-body-mobile">
            <div class="amounts-mobile">
              <div *ngIf="t.type === 'invest' || t.type === 'deposit'" class="amount-item-mobile principal">
                <span class="amount-label">PRINCIPAL:</span>
                <span class="amount-value">{{ t.amount | currency:'INR':'symbol':'1.2-2' }}</span>
              </div>
              <div *ngIf="t.type === 'interest'" class="amount-item-mobile interest">
                <span class="amount-label">INTEREST:</span>
                <span class="amount-value">{{ t.amount | currency:'INR':'symbol':'1.2-2' }}</span>
              </div>
              <div *ngIf="t.type === 'withdraw'" class="amount-item-mobile withdrawal">
                <span class="amount-label">WITHDRAWAL:</span>
                <span class="amount-value">{{ t.amount | currency:'INR':'symbol':'1.2-2' }}</span>
              </div>
            </div>
            <div class="balance-mobile">
              <span class="balance-label">BALANCE:</span>
              <span class="balance-value">{{ t.balance | currency:'INR':'symbol':'1.2-2' }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="report.transactions.length === 0" class="no-transactions">
      <span class="material-icons">receipt_long</span>
      <p>No transactions found for this period.</p>
    </div>
  </div>
</div>
